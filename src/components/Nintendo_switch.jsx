/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
Command: npx gltfjsx@6.4.1 nintendo_switch.glb --transform 
Files: nintendo_switch.glb [4.59MB] > C:\Users\capta\Desktop\New folder (2)\public\models\nintendo_switch-transformed.glb [257.62KB] (94%)
Author: gabrieljuan0322 (https://sketchfab.com/gabrieljuan0322)
License: CC-BY-4.0 (http://creativecommons.org/licenses/by/4.0/)
Source: https://sketchfab.com/3d-models/nintendo-switch-b94e6a6a8c564fee81c2d794da6c5712
Title: Nintendo Switch
*/

import { Environment, useGLTF, useScroll } from '@react-three/drei'
import { useFrame, useThree } from '@react-three/fiber';
import { useEffect, useRef, useState, useLayoutEffect } from 'react'
import { useControls } from "leva";
import {gsap} from 'gsap';
import {useGSAP} from '@gsap/react'
import { ScrollTrigger } from "gsap/dist/ScrollTrigger";



export default function Nintendo_switch(props) {
  const { nodes, materials } = useGLTF('/models/switch.gltf')

  const nSwitch = useRef();
  const { scene, camera } = useThree();
  const tl = gsap.timeline();


  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });

  const handleMouseMove = (event) => {
    setMousePosition({
      x: (event.clientX / window.innerWidth) * 4 - 1,
      y: (event.clientY / window.innerHeight) * 4 + 1,
    });
  };

  useEffect(() => {
    window.addEventListener('mousemove', handleMouseMove);
    return () => {
      window.removeEventListener('mousemove', handleMouseMove);
    };
  }, []);
  

  // // ----- used for getting the position for the shoes ----
  // const { cameraPosition, scenePosition, sceneRotation } = useControls({
  // 	cameraPosition: {
  // 		value: {
  // 			x: -1.100000000000002,
  //       y: -10.549999999999978,
  //       z: 0.050000000000000044,
  // 		},
  // 		step: 0.05,
  // 	},
  // 	scenePosition: {
  // 		value: { x:0.35,y:-8.199999999999987,z:-0.10000000000000052 },
  // 		step: 0.05,
  // 	},

  // 	sceneRotation: {
  // 		value: { x:-0.26000000000001094,y:-7.799999999999934,z:-0.2499999999999999 },
  // 		step: 0.01,
  // 	},
  // });

  //   // ---- used for debug ----
  // useFrame(() => {
  // 	camera.position.x = cameraPosition.x;
  // 	camera.position.y = cameraPosition.y;
  // 	camera.position.z = cameraPosition.z;
  // 	scene.position.x = scenePosition.x;
  // 	scene.position.y = scenePosition.y;
  // 	scene.position.z = scenePosition.z;
  // 	scene.rotation.x = sceneRotation.x;
  // 	scene.rotation.y = sceneRotation.y;
  // 	scene.rotation.z = sceneRotation.z;
  // });

  //Loading animation
  useGSAP(() => {
    gsap.to(scene.position, {
      x:0,y:-1.5,z:0,
      duration:2,
      delay:1
    })
    gsap.to(scene.rotation, {
      x:1.8,y:0,z:0,
      duration:2,
      delay:1, 
    })
  })

  //OnScroll Animations 
  useLayoutEffect(() => {
    new ScrollTrigger({});
    // component About.tsx
    tl.to(nSwitch.current.scale, {
      x: 0.14,
      y: 0.14,
      z: 0.14,
      scrollTrigger: {
        trigger: ".second-section",
        start: "top bottom",
        end: "top top",
        scrub: true,
        immediateRender: false,
      },
    })
      .to(nSwitch.current.position, {
        x: 0,
        y: -6,
        z: 0,
        scrollTrigger: {
          trigger: ".second-section",
          start: "top bottom",
          end: "top top",
          scrub: true,
          immediateRender: false,
        },
      })
    .to(nSwitch.current.scale, {
      x: 0.05,
      y: 0.05,
      z: 0.05,
      scrollTrigger: {
        trigger: ".third-section",
        start: "top bottom",
        end: "top top",
        scrub: true,
        immediateRender: false,
      },
    })
  }, []);

  return (
    <>
      <directionalLight
        castShadow
        intensity={2}
        position={[mousePosition.x , mousePosition.y, 1]}
      />
      <Environment preset='night' environmentIntensity={0.1}/>
      <ambientLight intensity={2} />
      <group {...props} dispose={null} ref={nSwitch} position={[0,-2.5,-0.8]} rotation={[-1.8,0,0]} scale={0.03}>
        <group rotation={[-Math.PI / 2, 0, 0]} >
          <group rotation={[Math.PI / 2, 0, 0]}>
            <mesh geometry={nodes.Nintendo_Switch_Nintendo_Switch_Material_0.geometry} material={materials.Nintendo_Switch_Material} position={[0, 0, 0]}  scale={1000} />
          </group>
        </group>
      </group>
    </>
    
  )
}

useGLTF.preload('/models/switch.gltf')
